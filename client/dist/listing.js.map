{"version":3,"file":"listing.js","sources":["../src/listing.ts"],"sourcesContent":["import type { Listing } from \"../../types/Listing\";\nconst BASE_URL = \"http://localhost:3000\";\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  const listingSlugId = new URLSearchParams(window.location.search).get(\"id\");\n  const listingWrapper = document.querySelector<HTMLDivElement>(\n    `[dev-target=listing-wrapper]`\n  );\n  const imageListDesktopWrapper = document.querySelector<HTMLDivElement>(\n    `[dev-target=image-list-desktop-wrapper]`\n  );\n  const listingLoader = document.querySelector<HTMLDivElement>(\n    `[dev-target=listing-loader]`\n  );\n  const imageItemDesktopTemplate = document.querySelector<HTMLDivElement>(\n    `[dev-target=image-item-desktop-template]`\n  );\n  const imageItemTabletWrap = document.querySelector<HTMLDivElement>(\n    `[dev-target=image-item-tablet-wrap]`\n  );\n  const imageItemTabletTemplate = document.querySelector<HTMLDivElement>(\n    `[dev-target=image-item-tablet-template]`\n  );\n  const listingTitle =\n    document.querySelector<HTMLDivElement>(`[dev-target=title]`);\n  const listingPrice =\n    document.querySelector<HTMLDivElement>(`[dev-target=price]`);\n  const listingContactUs = document.querySelector<HTMLLinkElement>(\n    `[dev-target=contact-us]`\n  );\n  const listingFloorPlan = document.querySelector<HTMLLinkElement>(\n    `[dev-target=floor-plan]`\n  );\n  const listingDescription = document.querySelector<HTMLDivElement>(\n    `[dev-target=description]`\n  );\n  if (\n    !listingWrapper ||\n    !listingLoader ||\n    !imageListDesktopWrapper ||\n    !imageItemDesktopTemplate ||\n    !imageItemTabletWrap ||\n    !imageItemTabletTemplate ||\n    !listingTitle ||\n    !listingPrice ||\n    !listingContactUs ||\n    !listingFloorPlan ||\n    !listingDescription\n  ) {\n    return console.error(\"Missing element\");\n  }\n\n  if (!listingSlugId) {\n    return console.error(\"Missing id\");\n  }\n\n  try {\n    const listing = await getListing(Number(listingSlugId));\n    console.log({ listing });\n    initPage({\n      imageItemDesktopTemplate,\n      imageItemTabletTemplate,\n      imageItemTabletWrap,\n      imageListDesktopWrapper,\n      listing,\n      listingLoader,\n      listingWrapper,\n      listingContactUs,\n      listingDescription,\n      listingFloorPlan,\n      listingPrice,\n      listingTitle,\n    });\n  } catch (error) {\n    console.error(\"Something went wrong\", error);\n  }\n\n  function initPage({\n    listing,\n    listingWrapper,\n    listingLoader,\n    imageListDesktopWrapper,\n    imageItemDesktopTemplate,\n    imageItemTabletWrap,\n    imageItemTabletTemplate,\n    listingTitle,\n    listingPrice,\n    listingContactUs,\n    listingFloorPlan,\n    listingDescription,\n  }: {\n    listing: Listing;\n    listingWrapper: HTMLElement;\n    listingLoader: HTMLElement;\n    imageListDesktopWrapper: HTMLElement;\n    imageItemDesktopTemplate: HTMLElement;\n    imageItemTabletWrap: HTMLElement;\n    imageItemTabletTemplate: HTMLElement;\n    listingTitle: HTMLElement;\n    listingPrice: HTMLElement;\n    listingContactUs: HTMLLinkElement;\n    listingFloorPlan: HTMLLinkElement;\n    listingDescription: HTMLElement;\n  }) {\n    const desktopPhotos = listing.photos.slice(0, 3);\n    const tabletPhotos = listing.photos.slice(0, 8);\n\n    imageListDesktopWrapper.innerHTML = \"\";\n    imageItemTabletWrap.innerHTML = \"\";\n    desktopPhotos.map((photo) => {\n      const imageItemDesktop = imageItemDesktopTemplate.cloneNode(\n        true\n      ) as HTMLElement;\n      const imageDesktop = imageItemDesktop.querySelector<HTMLImageElement>(\n        `[dev-target=listing-image]`\n      );\n      if (!imageDesktop)\n        return console.error(\"dev-target=listing-image not found\");\n      imageDesktop.src = photo.original;\n      imageDesktop.srcset = \"\";\n      imageListDesktopWrapper.appendChild(imageItemDesktop);\n    });\n\n    tabletPhotos.map((photo) => {\n      const imageItemTablet = imageItemTabletTemplate.cloneNode(\n        true\n      ) as HTMLElement;\n      const imageTablet = imageItemTablet.querySelector<HTMLImageElement>(\n        `[dev-target=listing-image]`\n      );\n      if (!imageTablet)\n        return console.error(\"dev-target=listing-image not found\");\n      imageTablet.src = photo.original;\n      imageTablet.srcset = \"\";\n      imageItemTabletWrap.appendChild(imageItemTablet);\n    });\n    window.Webflow.require(\"slider\").redraw();\n    window.dispatchEvent(new Event(\"resize\"));\n\n    listingTitle.innerText = `${listing.bedrooms} BED, ${listing.bathrooms} BATH`;\n    listingPrice.innerText = `$${Number(listing.price).toLocaleString()}`;\n    listingContactUs.href = `#`;\n    listingFloorPlan.href = `#`;\n    listingDescription.textContent = listing.description;\n\n    toggleHideElement({ element: listingLoader, toggle: \"hide\" });\n    toggleHideElement({ element: listingWrapper, toggle: \"show\" });\n  }\n  async function getListing(id: number) {\n    try {\n      const response = await fetch(`${BASE_URL}/api/listings/${id}`);\n      if (!response.ok) {\n        throw new Error(\"Failed to fetch job\");\n      }\n      const job: Listing = await response.json();\n      return job;\n    } catch (error) {\n      console.error(\"Error fetching job:\", error);\n      throw error;\n    }\n  }\n  function toggleHideElement({\n    element,\n    toggle,\n  }: {\n    element: HTMLElement;\n    toggle: \"show\" | \"hide\";\n  }) {\n    if (toggle === \"show\") {\n      element.setAttribute(\"dev-hide\", \"false\");\n    } else {\n      element.setAttribute(\"dev-hide\", \"true\");\n    }\n  }\n});\n"],"names":["BASE_URL","listingSlugId","listingWrapper","imageListDesktopWrapper","listingLoader","imageItemDesktopTemplate","imageItemTabletWrap","imageItemTabletTemplate","listingTitle","listingPrice","listingContactUs","listingFloorPlan","listingDescription","listing","getListing","initPage","error","desktopPhotos","tabletPhotos","photo","imageItemDesktop","imageDesktop","imageItemTablet","imageTablet","toggleHideElement","id","response","element","toggle"],"mappings":"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"}