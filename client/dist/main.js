document.addEventListener("DOMContentLoaded",async()=>{const P="http://localhost:3000",v=document.querySelector("[dev-target=listing-loader]"),S=document.querySelector("[dev-target=listing-list]"),q=document.querySelector("[dev-target=listing-item-template]"),E=document.querySelector("[dev-target=listing-form]"),w=document.querySelector("[dev-target=empty-state]");let d="",u=0,p=1/0,y="",o=null;if(!q||!S||!v||!E||!w)return console.error("Missing required elements");try{const e=await T();o=e,console.log({listings:e}),h({listings:e,emptyState:w,listingItemTemplate:q,listingList:S,listingLoader:v}),b({listingForm:E,listingItemTemplate:q,listingList:S,listingLoader:v,emptyState:w})}catch{}function h({listings:e,listingList:i,listingLoader:l,listingItemTemplate:a,emptyState:c}){i.innerHTML="",e.items.forEach(t=>{const n=a.cloneNode(!0),g=n.querySelector("[dev-target=title]"),m=n.querySelector("[dev-target=price]"),r=n.querySelector("[dev-target=listing-type]"),s=n.querySelector("[dev-target=image]");if(!g||!s||!m||!r)return console.error("Missing listing item elements");n.href=`/property?id=${t.id}`,s.src=t.photos[0].original,g.textContent=`${t.bedrooms} BED, ${t.bathrooms} BATH`,m.textContent=Number(t.price).toLocaleString(),r.textContent=t.property_type,i.appendChild(n)}),e.items.length===0?f({element:c,toggle:"show"}):f({element:c,toggle:"hide"}),f({element:l,toggle:"hide"}),f({element:i,toggle:"show"})}function f({element:e,toggle:i}){i==="show"?e.setAttribute("dev-hide","false"):e.setAttribute("dev-hide","true")}async function T(){try{const e=await fetch(`${P}/api/listings`);if(!e.ok)throw new Error("Failed to fetch listings");return await e.json()}catch(e){throw console.error("Error fetching listings:",e),e}}function b({listingForm:e,listingItemTemplate:i,listingList:l,listingLoader:a,emptyState:c}){const t=e.querySelector("[dev-target=listing-search]"),n=e.querySelector("[dev-target=listing-unit]"),g=e.querySelector("[dev-target=listing-min-price]"),m=e.querySelector("[dev-target=listing-max-price]");t==null||t.addEventListener("input",r=>{if(y=r.target.value,console.log({listingSearch:y}),o){const s=L({listings:o,maxPrice:p,minPrice:u,search:y,unitType:d});h({listings:s,listingItemTemplate:i,listingList:l,listingLoader:a,emptyState:c})}}),m==null||m.addEventListener("change",r=>{const s=r.target.value;if(p=s===""?1/0:Number(s),console.log({maxListing:p}),o){const x=L({listings:o,maxPrice:p,minPrice:u,search:y,unitType:d});h({listings:x,listingItemTemplate:i,listingList:l,listingLoader:a,emptyState:c})}}),g==null||g.addEventListener("change",r=>{if(u=Number(r.target.value),console.log({minListing:u}),o){const s=L({listings:o,maxPrice:p,minPrice:u,search:y,unitType:d});h({listings:s,listingItemTemplate:i,listingList:l,listingLoader:a,emptyState:c})}}),n==null||n.addEventListener("change",r=>{if(d=r.target.value,console.log({currentUnitType:d}),o){const s=L({listings:o,maxPrice:p,minPrice:u,search:y,unitType:d});h({listings:s,listingItemTemplate:i,listingList:l,listingLoader:a,emptyState:c})}})}function L({listings:e,search:i,unitType:l,minPrice:a,maxPrice:c}){return{...e,items:e.items.filter(t=>{const n=i===""||t.property_type.toLowerCase().includes(i.toLowerCase()),g=l===""||l.toLowerCase().trim()===t.property_type.toLowerCase().trim(),m=Number(t.price)>=a,r=Number(t.price)<=c;return n&&m&&r&&g})}}});
//# sourceMappingURL=main.js.map
